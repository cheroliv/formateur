= Utilisation de Moodle avec Docker Desktop
@CherOliv
2023-12-22
:jbake-title: Moodle Document
:jbake-type: post
:jbake-tags: blog, ticket, moodle, memo
:jbake-status: published
:jbake-date: 2023-12-22
:summary: Simple document sur Moodle


== [underline]#Table des Matières# [[toc]]
. <<goals>>
.. <<prerequis>>
. <<exec_docker>>
.. <<config_volumes>>
.. <<expose_port>>
.. <<use_postgres>>
. <<start_reload>>
.. <<first_exec>>
.. <<reload_moodle>>
.. <<check_status>>
. <<screenshots>>
.. <<screenshots_volumes>>
.. <<screenshots_expose_port>>
.. <<screenshots_first_exec>>
.. <<screenshot_reload>>

== Objectifs du Document [[goals]]

Ce document vise à fournir aux formateurs numériques les connaissances nécessaires pour maîtriser l'utilisation de Moodle dans le contexte de l'e-learning.

.Les objectifs spécifiques comprennent :
. Comprendre les prérequis nécessaires pour l'installation de Moodle avec Docker Desktop.
. Apprendre à configurer les volumes pour assurer la sauvegarde des données.
. Maîtriser l'exposition des ports pour permettre l'accès à Moodle depuis l'extérieur de la machine.
. Choisir et configurer PostgreSQL comme base de données pour Moodle.
. Acquérir les compétences nécessaires pour exécuter et relancer l'image Moodle avec Docker.
. Savoir vérifier l'état actuel du conteneur Moodle.
. Visualiser chaque étape du processus à l'aide de captures d'écran didactiques.

Ce document est conçu pour vous accompagner pas à pas dans la mise en place de Moodle, en mettant l'accent sur la simplicité et la compréhension approfondie des étapes impliquées.

== Prérequis [[prerequis]]

<<toc>>

== Exécution de Moodle avec Docker [[exec_docker]]

=== Configuration des volumes de données [[config_volumes]]

Pour assurer la sauvegarde des données Moodle, nous devons configurer des volumes Docker.
Créez les volumes en utilisant les commandes suivantes :

[source,bash]
----
docker volume create moodle_data
docker volume create moodle_db_data
----

Ces volumes garantissent que les données de Moodle persistent même après l'arrêt du conteneur.

<<toc>>

=== Exposition des ports [[expose_port]]

Pour permettre l'accès à Moodle depuis l'extérieur de la machine, exposez les ports nécessaires avec la commande suivante :

[source,bash]
----
docker run -d -p 8080:80 -p 443:443 \
  --name moodle \
  -v moodle_data:/var/www/html \
  -v moodle_db_data:/var/lib/postgresql/data \
  moodlehq/moodle:latest
----

Cette commande expose les ports 8080 et 443 sur votre machine hôte.

<<toc>>

=== Utilisation de PostgreSQL comme base de données [[use_postgres]]

Moodle prend en charge différentes bases de données, mais nous privilégions PostgreSQL.
Lancez le conteneur PostgreSQL avec la commande suivante :

[source,bash]
----
docker run -d --name moodle-db \
  -e POSTGRES_PASSWORD=your_password \
  -v moodle_db_data:/var/lib/postgresql/data \
  postgres:latest
----

Remplacez `your_password` par un mot de passe sécurisé.

<<toc>>

== Exécution et Relance de Moodle [[start_reload]]

=== Exécution initiale de Moodle [[first_exec]]

1. Ouvrez une fenêtre de terminal.

2. Assurez-vous que Docker Desktop est en cours d'exécution.

3. Exécutez la commande suivante pour lancer Moodle pour la première fois :

[source,bash]
----
docker run -d -p 8080:80 -p 443:443 \
  --name moodle \
  -v moodle_data:/var/www/html \
  -v moodle_db_data:/var/lib/postgresql/data \
  moodlehq/moodle:latest
----

<<toc>>

=== Relance de Moodle [[reload_moodle]]

Si vous devez relancer Moodle après l'avoir arrêté ou redémarré votre machine, utilisez la commande suivante :

[source,bash]
----
docker start moodle
----

Cela relance le conteneur Moodle avec les mêmes paramètres que précédemment.

<<toc>>

=== Vérification de l'état de Moodle [[check_status]]

Vous pouvez vérifier l'état actuel du conteneur en utilisant la commande suivante :

[source,bash]
----
docker ps
----

Assurez-vous que le conteneur "moodle" est en cours d'exécution.

<<toc>>

== Captures d'écran Didactiques [[screenshots]]

=== Configuration des Volumes [[screenshots_volumes]]

- [Capture d'écran : Configuration des Volumes](lien_vers_capture_d_ecran_volumes)

<<toc>>

=== Exposition des Ports [[screenshots_expose_port]]

- [Capture d'écran : Exposition des Ports](lien_vers_capture_d_ecran_ports)

<<toc>>

=== Exécution Initiale de Moodle [[screenshots_first_exec]]

- [Capture d'écran : Exécution Initiale de Moodle](lien_vers_capture_d_ecran_execution)

<<toc>>

=== Relance de Moodle [[screenshot_reload]]

- [Capture d'écran : Relance de Moodle](lien_vers_capture_d_ecran_relance)

<<toc>>
